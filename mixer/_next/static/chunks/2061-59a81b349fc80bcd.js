"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2061],{32061:function(a,b,c){c.r(b),c.d(b,{ChatInbox:function(){return a0},ChatMessageChain:function(){return cD},ChatProductMessages:function(){return cF}});var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P=c(7896),Q=c(2784),R=c(87043),S=c(5632),T=c.n(S),U=c(80425),V=c(89382),W=c(14232),X=c(87333),Y=c(76854),Z=c(54073),$=c.n(Z),_=c(76613),aa=c(34490),ab=c(71171),ac=c(99673),ad=c(91489),ae=ac.ZP.div(d||(d=(0,ab.Z)(["\n  position: absolute;\n  background-color: #fff;\n  border-radius: 50%;\n  box-shadow: ",";\n  left: 50%;\n  transform: translateX(-50%);\n  width: 40px;\n  height: 40px;\n  padding: 4px;\n\n  ","\n\n  ","\n\n  ","\n"])),(0,ad.R)("boxShadows.1"),function(a){return"top"===a.align&&(0,ac.iv)(e||(e=(0,ab.Z)(["\n      top: 8px;\n    "])))},function(a){return"bottom"===a.align&&(0,ac.iv)(f||(f=(0,ab.Z)(["\n      bottom: 8px;\n    "])))},function(a){return"center"===a.align&&(0,ac.iv)(g||(g=(0,ab.Z)(["\n      top: 50%;\n      transform: translate(-50%, -50%);\n    "])))}),af=function(a){var b=a.align;return Q.createElement(ae,{align:b,"data-testid":"chat-loading"},Q.createElement(aa.JO$,{name:"AnimatedLoading3",width:32,height:32}))};af.defaultProps={align:"bottom"};var ag=af,ah=function(a){var b=a.onRetry;return Q.createElement(R.kC,{flexDirection:"column",justifyContent:"space-around","data-testid":"ConnErrorState-Root"},Q.createElement(R.xu,null,Q.createElement(R.Ee,{title:"Imagem ilustrativa - Conex\xe3o remota com falha",alt:"Imagem ilustrativa - Conex\xe3o remota com falha",width:"100%",height:"50vh",src:"https://wx.mlcdn.com.br/site/chat/cable-disconnected-colorful.svg"})),Q.createElement(R.xu,{textAlign:"center",p:"2",role:"alert","aria-live":"assertive"},Q.createElement(R.xv,{fontSize:6,fontWeight:"bold",mb:4},"Erro inesperado"),Q.createElement(R.xv,{fontSize:2},"Isso pode ocorrer por uma instabilidade ou problema de conex\xe3o tempor\xe1ria.")),Q.createElement(R.xu,{textAlign:"center",p:"2"},Q.createElement(R.xv,{fontSize:2,mb:3},"Por favor, aguarde alguns instantes e tente novamente."),Q.createElement(R.zx,{full:!0,centered:!0,onClick:b,size:"large",uppercase:!1},"Tentar novamente")))},ai=(0,Q.memo)(ah),aj=c(59740),ak=c(86522),al=c(36631),am=c(6738),an=c(36076),ao=c(34291),ap=c.n(ao),aq=c(76635),ar=c(56666),as=function(a){var b,c=(0,Q.useRef)({}),d=function(b,d){var e=d.elementRef.offsetHeight,f=d.windowWidth,g=d.id;c.current=(0,P.Z)({},c.current,(0,ar.Z)({},g,{height:e,id:g,windowWidth:f})),a.current.resetAfterIndex(b)},e=function(a,b){var e=c.current[b.id],f=b.windowWidth!==e.windowWidth,g=b.elementRef.offsetHeight!==e.height;(f||g)&&d(a,b)};return[function(a){return c.current[a]?c.current[a].height:0},(0,Q.useCallback)(function(b,f){a.current&&f&&(c.current[f.id]?e(b,f):d(b,f))},[a.current])]},at=function(a){var b=(0,Q.useRef)(),c=a.data,d=a.index,e=a.id,f=a.onSetSize,g=a.windowWidth,h=c.renderRow;return(0,Q.useEffect)(function(){f(d,{elementRef:b.current,id:e,windowWidth:g})},[f,g,d]),Q.createElement("div",{ref:b},h(d))};at.defaultProps={onSetSize:ap()},at.ssr=!1;var au=(0,Q.memo)(at),av=["renderRow","listRef","onScroll"],aw=(0,al.Z)(function(a){return{renderRow:a}}),ax=function(){for(var a=arguments.length,b=Array(a),c=0;c<a;c++)b[c]=arguments[c];return function(a){b.forEach(function(b){"function"==typeof b&&b(a),"object"===(0,ak.Z)(b)&&(b.current=a)})}},ay=function(a){var b=a.renderRow,c=a.listRef,d=a.onScroll,e=(0,aj.Z)(a,av),f=(0,Q.useRef)(),g=as(f),h=(0,Y.Z)(g,2),i=h[0],j=h[1],k=aw(b),l=(0,Q.useCallback)(function(a,b){Object.prototype.hasOwnProperty.call(e,"itemSize")||j(a,b)},[]),m=function(a){var b;return"liid:".concat(null!==(b=e.itemKey(a))&& void 0!==b?b:a)},n=function(a){var b;return"likey:".concat(null!==(b=e.itemKey(a))&& void 0!==b?b:a)},o=(0,aq.debounce)(function(a){var b;return Q.createElement(an.S_,(0,P.Z)({ref:ax(c,f),itemData:k,width:a.width,height:a.height,itemSize:function(a){var b=m(a);return i(b,a)},onScroll:(b=a,function(a){null==d||d(a,b)})},e,{itemKey:n}),function(b){var c=b.data,d=b.index,e=b.style,f=m(d);return Q.createElement("div",{style:e,key:f},Q.createElement(au,{id:f,data:c,index:d,onSetSize:l,windowWidth:a.width}))})},10,{leading:!0,trailing:!0});return Q.createElement(am.ZP,null,o)};ay.defaultProps={itemKey:ap(),listRef:ap(),onScroll:ap()},ay.ssr=!1;var az=(0,Q.memo)(ay),aA=function(a,b){return a||b},aB={makeHandleScroll:function(a,b){var c=a.loading,d=a.onLoadPreviousItems,e=a.onLoadNextItems,f=a.hasPreviousItems,g=a.hasNextItems,h=$()(function(){return null==d?void 0:d()},100),i=$()(function(){return null==e?void 0:e()},100);return function(a,d){var e,j,k=a.scrollOffset,l=a.scrollDirection,m=d.height;if(!c){f&&"backward"===(e=l)&&b.current&&k<60&&h(),g&&"forward"===(j=l)&&b.current&&b.current.scrollHeight-m-60<k&&i()}}}},aC=["loading","onLoadPreviousItems","onLoadNextItems","hasPreviousItems","hasNextItems"],aD=function(a){a.loading,a.onLoadPreviousItems,a.onLoadNextItems,a.hasPreviousItems,a.hasNextItems;var b=(0,aj.Z)(a,aC),c=(0,Q.useRef)(),d=aB.makeHandleScroll(a,c);return Q.createElement(az,(0,P.Z)({},b,{onScroll:d,innerRef:c}))};aD.defaultProps={hasNextItems:void 0,hasPreviousItems:void 0,loading:void 0,onLoadNextItems:void 0,onLoadPreviousItems:void 0},aD.ssr=!1;var aE=(0,Q.memo)(aD),aF=(0,ac.ZP)(R.xu).attrs(function(a){return(0,P.Z)({flex:"1 1 auto",height:"100%",minHeight:0,overflow:"hidden",position:"relative",width:"100%"},a)})(h||(h=(0,ab.Z)([""]))),aG=c(27439),aH=c(19527),aI=c(97851),aJ=ac.ZP.div(i||(i=(0,ab.Z)(["\n  > div > button > div {\n    height: 20px;\n    width: auto;\n    min-width: 20px;\n    border-radius: 10px;\n    top: 0;\n    bottom: auto;\n    z-index: 1;\n    transform-origin: 100% 0%;\n    transform: scale(1) translate(35%, -35%);\n  }\n"]))),aK=(0,ac.ZP)(aG.ZP)(j||(j=(0,ab.Z)(["\n  display: flex;\n  border-radius: 0;\n  border-bottom: 1px solid ",";\n"])),(0,ad.R)("colors.lightSilver")),aL=(0,ac.ZP)(aG.ZP.Subtitle)(k||(k=(0,ab.Z)(["\n  white-space: nowrap;\n"]))),aM=function(a){var b=a.name,c=a.description,d=a.date,e=a.onClick,f=a.badgeCount;return Q.createElement(aK,{onClick:e,"data-testid":"chat-contact-card"},Q.createElement(aH.Z,{flexDirection:"row",gap:3,alignItems:"center",width:"100%",padding:"16px 20px"},Q.createElement(aJ,null,Q.createElement(aI.Z,{amount:f,backgroundColor:"transparent",counterColor:"#0086ff",fontColor:"#fff",truncateAmountThreshold:10,nullable:!1},Q.createElement(aa.JO$,{name:"SellerStore",width:40,height:40}))),Q.createElement(aH.Z,{justifyContent:"space-between",gap:2,flex:1},Q.createElement("div",null,Q.createElement(aG.ZP.Subtitle,{"data-testid":"chat-contact-card-name",fontSize:"1rem",lineHeight:"1.125rem",fontWeight:500,lines:1,marginTop:0,truncate:!0},b),c&&Q.createElement(aG.ZP.Subtitle,{color:"scratched",fontSize:"0.875rem",fontWeight:400,lineHeight:"1rem",lines:1,marginTop:1,truncate:!0},c)),d&&Q.createElement(aL,{color:"scratched",fontWeight:400,marginTop:0,whiteSpace:"nowrap"},d))))};aM.defaultProps={badgeCount:0,date:void 0,description:void 0};var aN=(0,Q.memo)(aM),aO=ac.ZP.span(l||(l=(0,ab.Z)(["\n  position: relative;\n"]))),aP=ac.ZP.span(m||(m=(0,ab.Z)(["\n  position: absolute;\n  width: 30px;\n  height: 30px;\n  background-color: ",";\n  border-radius: ",";\n  display: inline-flex;\n  align-items: center;\n  justify-content: center;\n  right: 0;\n"])),function(a){return(0,ad.dF)("primary")(a)},(0,ad.R)("radii.circle")),aQ=function(a){return Q.createElement(R.kC,(0,P.Z)({},a,{flexDirection:"column",justifyContent:"center","data-testid":"EmptyState-Root"}),Q.createElement(R.xu,{textAlign:"center"},Q.createElement(aO,null,Q.createElement(aa.JO$,{name:"SellerStore",height:"104px",width:"104px"}),Q.createElement(aP,{title:"N\xfamero de conversas: 0"},Q.createElement(R.xv,{color:"text.white",fontWeight:"bold"},"0")))),Q.createElement(R.xu,{textAlign:"center",p:"2"},Q.createElement(R.xv,{fontSize:5,lineHeight:"big",fontWeight:"bold",mb:4},"Voc\xea ainda n\xe3o tem conversas com lojistas")))},aR=(0,Q.memo)(aQ),aS=(0,ac.ZP)(aR)(n||(n=(0,ab.Z)(["\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n"]))),aT=["items","onClickItem","onLoadNextItems","hasNextItems","loading"],aU=function(a){var b=a.items,c=a.onClickItem,d=a.onLoadNextItems,e=a.hasNextItems,f=a.loading,g=(0,aj.Z)(a,aT),h=b.length,i=function(){return 69},j=function(a){var d,e=b[a];return Q.createElement(aN,{name:e.toUser.fullName,description:null==e?void 0:null==(d=e.lastMessage)?void 0:d.content,date:e.lastInteractionAt,onClick:function(){return c(e,a)},badgeCount:e.unreadFromCount})};return Q.createElement(aF,(0,P.Z)({"data-testid":"chat-conversation-list"},g,{bg:"background.white"}),Q.createElement(aE,{itemCount:h,itemSize:i,renderRow:j,onLoadNextItems:d,hasNextItems:e,loading:f}),0===h&&Q.createElement(aS,null),f&&Q.createElement(ag,null))};aU.defaultProps={hasNextItems:void 0,loading:void 0,onLoadNextItems:void 0},aU.ssr=!1;var aV=(0,Q.memo)(aU),aW=c(46275),aX=(0,ac.ZP)(R.kC).attrs(function(a){return(0,P.Z)({flexDirection:"column",fontFamily:'"MagaluTextos", sans-serif',height:"100%",width:"100%"},a)})(o||(o=(0,ab.Z)([""]))),aY=(0,ac.ZP)(aW.HS)(p||(p=(0,ab.Z)(["\n  border-radius: 12px;\n  margin: 8px 8px 32px 8px;\n  border: none;\n\n  & div {\n    height: 48px;\n  }\n\n  div & :focus {\n    outline: 1px solid ",";\n  }\n"])),(0,ad.dF)("opacityBlue")),aZ=function(a){var b=a.onClickItem,c=a.userData,d=a.staticProps,e=c.id,f=(0,Q.useState)(""),g=(0,Y.Z)(f,2),h=g[0],i=g[1],j=(0,_.useChatConversations)({search:h,staticProps:d,userId:e}),k=j.items,l=j.loading,m=j.error,n=j.hasNextPage,o=j.fetchNextPage,p=j.fetchMore,q=j.refetch;(0,Q.useEffect)(function(){p()},[h]);var r=function(a){i(a.target.value)},s=function(){i("")},t=$()(r,500);return m?Q.createElement(ai,{onRetry:q}):Q.createElement(aX,{bg:"background.base"},Q.createElement(aY,{label:"lojista",onChange:t,onClearInput:s}),!k&&l&&Q.createElement(ag,{align:"center"}),k&&Q.createElement(aV,{loading:l,items:k,onClickItem:b,hasNextItems:n,onLoadNextItems:o}))},a$=(0,Q.memo)(aZ),a_=function(a){var b=a.structure,c=a.static,d=b.route,e=(0,W.Cv)({structure:b}),f=e.data,g=e.loading,h=(0,X.Np)().publish,i=!!(null==d?void 0:d.sellerId);(0,Q.useEffect)(function(){if(i){var a="/chat-com-lojista/p/".concat(d.sellerId,"/").concat((null==d?void 0:d.productId)?d.productId:"");T().replace(a)}},[]),(0,Q.useEffect)(function(){if(f){var a,c;h("sellerchat:inbox:conversations:onview",{userId:f.id,userIsLogged:f.isLogged,userLocation:(0,P.Z)({},null==b?void 0:null==(a=b.cookies)?void 0:a.location,{zipCode:null==b?void 0:null==(c=b.cookies)?void 0:c.zipCode})})}},[f]);var j=function(a){var b;h("sellerchat:inbox:conversations:onclick",{sellerId:a.toUser.refKey,userId:f.id}),(0,U.dY)({path:"/chat-com-lojista/p/".concat(null==(b=a.toUser)?void 0:b.refKey,"/"),spa:!0})};return i||g?Q.createElement(R.SX,null):(null==f?void 0:f.isLogged)?Q.createElement(a$,{onClickItem:j,userData:f,staticProps:c}):Q.createElement(R.kC,{width:"100%",justifyContent:"center",alignItems:"center"},Q.createElement(R.xv,null,"Usu\xe1rio n\xe3o autorizado"))};a_.defaultProps={static:{},structure:{}},a_.ssr=!0;var a0=(0,V.Z)(a_),a1=c(34795),a2=ac.ZP.div(q||(q=(0,ab.Z)(["\n  border-radius: ",";\n  width: 48px;\n  height: 48px;\n  color: ",";\n  text-align: center;\n"])),function(a){return(0,ad.R)("radii.circle")(a)},function(a){return(0,ad.dF)("white")(a)}),a3=ac.ZP.header(r||(r=(0,ab.Z)(["\n  width: 100%;\n  display: flex;\n  height: 64px;\n  background-color: ",";\n  align-items: center;\n  justify-content: flex-start;\n  padding: ","px ","px;\n\n  & span {\n    margin-left: ","px;\n    font-size: ","px;\n    font-weight: ",";\n  }\n"])),function(a){return(0,ad.dF)("white")(a)},(0,ad.R)("space.2"),(0,ad.R)("space.3"),(0,ad.R)("space.2"),(0,ad.R)("fontSizes.3"),(0,ad.R)("fontWeights.medium")),a4=function(a){var b=a.label,c=a.avatarIcon;return Q.createElement(a3,{"data-testid":"chat-conversation-header-root"},Q.createElement(a2,null,Q.createElement(aa.JO$,{name:c,color:"background.primary",width:48,height:48})),Q.createElement("span",{"data-testid":"chat-conversation-header-title"},b))},a5=a4,a6=ac.ZP.div(s||(s=(0,ab.Z)(["\n  display: flex;\n  flex-direction: row;\n  width: 100%;\n  align-items: center;\n  gap: ",";\n  padding: 8px 4px 16px 4px;\n\n  > hr {\n    flex: 1;\n    margin: 0;\n    height: 0px;\n    border-width: 1px 0 0 0;\n    border-color: ",";\n  }\n\n  > span {\n    color: ",";\n    font-weight: ",";\n    font-size: ","px;\n    line-height: ","px;\n    background-color: ",";\n    border-radius: ",";\n    padding: 4px 16px;\n    flex: none;\n    flex-grow: 0;\n  }\n"])),function(a){return(0,ad.R)("space.2")(a)},function(a){return(0,ad.ow)("text.white")(a)},function(a){return(0,ad.ow)("text.white")(a)},(0,ad.R)("fontWeights.medium"),(0,ad.R)("fontSizes.2"),(0,ad.R)("lineHeights.tall"),function(a){return(0,ad.R)("colors.gray")(a)},function(a){return(0,ad.R)("radii.big")(a)}),a7=["children"],a8=function(){return 50},a9=function(a){var b=a.children,c=(0,aj.Z)(a,a7);return Q.createElement(a6,(0,P.Z)({"data-testid":"chat-date-message"},c),Q.createElement("hr",null),Q.createElement("span",null,b),Q.createElement("hr",null))};a9.getHeight=a8;var ba=a9,bb=(0,ad.R)("radii.default"),bc="64px",bd=(0,ac.ZP)("span")(t||(t=(0,ab.Z)(["\n  line-height: normal;\n  margin-top: 5px;\n  background: ",";\n  border-radius: 50%;\n  width: 10px;\n  height: 10px;\n  display: block;\n  text-align: center;\n  font-size: 8px;\n  flex: none;\n  color: ",";\n"])),function(a){return(0,ad.R)("palette.alert.danger.text")(a)},function(a){return(0,ad.R)("palette.alert.danger.base")(a)}),be=(0,ac.ZP)("form")(u||(u=(0,ab.Z)(["\n  padding: ","px ","px ","px\n    ","px;\n  box-shadow: ",";\n"])),(0,ad.R)("space.2"),(0,ad.R)("space.1"),(0,ad.R)("space.1"),(0,ad.R)("space.1"),(0,ad.R)("boxShadows.4")),bf=(0,ac.ZP)(R.zx)(v||(v=(0,ab.Z)(["\n  color: ",";\n  background-color: ",";\n  padding: 0;\n  min-width: 48px;\n  height: inherit;\n  min-height: ",";\n  border-radius: 0px "," "," 0px;\n  border: ","!important;\n  border-left: none !important;\n  :disabled {\n    opacity: 0.7;\n    background-color: ",";\n    color: ",";\n    min-height: ",";\n  }\n  &:focus {\n    background-color: ",";\n    outline: 1px solid ",";\n    outline-offset: -3px;\n  }\n  svg {\n    fill: ",";\n  }\n"])),(0,ad.uu)("primary"),(0,ad.dF)("white"),bc,bb,bb,(0,ad.R)("borders.0"),(0,ad.dF)("base"),(0,ad.uu)("gray"),bc,(0,ad.dF)("base"),(0,ad.dF)("opacityBlue"),function(a){return(0,ad.uu)(a.disabled?"gray":"primary")(a)}),bg=(0,ac.ZP)(R.II)(w||(w=(0,ab.Z)(["\n  min-height: ",";\n  max-height: 20vh;\n  border-radius: "," 0px 0px ",";\n  border: ",";\n  border-right: none;\n  font-size: ","px;\n  font-style: normal;\n  font-weight: ",";\n  line-height: ",";\n  flex-grow: 1;\n  padding: ","px;\n  &:focus {\n    background-color: ",";\n    outline: 1px solid ",";\n    outline-offset: -3px;\n  }\n"])),bc,bb,bb,(0,ad.R)("borders.0"),(0,ad.R)("fontSizes.3"),(0,ad.R)("fontWeights.regular"),(0,ad.R)("lineHeights.input"),(0,ad.R)("space.2"),(0,ad.dF)("base"),(0,ad.dF)("opacityBlue")),bh=(0,ac.ZP)(R.kC)(x||(x=(0,ab.Z)(["\n  justify-items: stretch;\n"]))),bi=(0,ac.ZP)(R.xu)(y||(y=(0,ab.Z)(["\n  border-radius: 0px 0px "," ",";\n  border: ",";\n  padding: ","px;\n  margin: 4px 0 0 0;\n  background-color: ",";\n  border-color: #f1aeb5;\n  display: flex;\n  gap: ","px;\n"])),bb,bb,(0,ad.R)("borders.0"),(0,ad.R)("space.1"),function(a){return(0,ad.R)("palette.alert.danger.base")(a)},(0,ad.R)("space.1")),bj=function(a){var b=a.ref;function c(){if(b&&b.current){var a=b.current,c=a.clientHeight;a.style.height="inherit";var d=Math.max(c,a.scrollHeight);a.style.height="".concat(d,"px")}}return(0,Q.useEffect)(c),{resetHeightTextarea:function(){b&&b.current&&(b.current.focus(),b.current.style.height="initial")},resizeTextarea:c}},bk=function(a){var b=a.target.value,c=a.target.selectionStart;return"".concat(b.slice(0,c),"\n").concat(b.slice(c))},bl=function(a){var b=a.handleOnSubmit,c=a.inputRef,d=(0,Q.useState)(""),e=(0,Y.Z)(d,2),f=e[0],g=e[1],h=bj({ref:c}).resetHeightTextarea,i=(0,Q.useMemo)(function(){return f.trim().length>0&&null===f.match(/^[^a-zA-Z0-9]+$/)},[f]),j=function(a){a.preventDefault(),i&&(b({message:f.trim(),ref:{resetForm:function(){g("")}}}),c.current.focus(),h())};return{handleChangeEvent:function(a){g(a.target.value)},handleKeyDownEvent:function(a){"Enter"!==a.code||a.shiftKey||"Enter"!==a.code||a.ctrlKey||j(a)},handleKeyPressEvent:function(a){if("Enter"===a.code&&a.shiftKey||"Enter"===a.code&&a.ctrlKey){a.preventDefault();var b=bk(a);g(b)}},handleSubmitEvent:j,isValid:i,value:f}},bm=function(a){var b=a.onSubmit,c=a.loading,d=a.error,e=(0,Q.useRef)(),f=bl({handleOnSubmit:b,inputRef:e}),g=f.handleChangeEvent,h=f.handleSubmitEvent,i=f.handleKeyDownEvent,j=f.handleKeyPressEvent,k=f.isValid,l=f.value,m=(0,Q.useMemo)(function(){return c?"AnimatedLoading3":"Send"},[c]);return Q.createElement(be,{onSubmit:h,"aria-keyshortcuts":"Enter"},Q.createElement(bh,null,Q.createElement(bg,{style:{borderBottomLeftRadius:d?0:"6px"},"aria-required":"true","aria-errormessage":"message-form-error","aria-invalid":!1===k,value:l,ref:e,onKeyPress:j,onKeyDown:i,onChange:g,multiline:!0,rows:1,fullWidth:!0,autocomplete:"off",tabindex:0,spellcheck:"true",placeholder:"Digite uma mensagem..."}),Q.createElement(bf,{style:{borderBottomRightRadius:d?0:"6px !important"},"aria-label":"Enviar mensagem",type:"submit",tabindex:0,disabled:!k,outline:!0,centered:!0,variant:"contained",color:"default",size:"large"},Q.createElement(aa.JO$,{name:m,"data-icon-name":m,width:32,height:32}))),Q.createElement(bi,{bg:"alerts.danger-base",style:{display:d?"flex":"none"}},Q.createElement(bd,{color:"error",fontSize:"1",fontWeight:"bold","data-testid":"error-icon"},"!"),Q.createElement(R.xv,{"aria-label":d,color:"error",id:"message-form-error",fontSize:"1",lineHeight:"150%",role:"alert",ml:"1"},d)))};bm.defaultProps={error:"",loading:!1};var bn=ac.ZP.li(z||(z=(0,ab.Z)(["\n  &:focus {\n    outline: 2px solid ",";\n    outline-offset: 2px;\n  }\n"])),(0,ad.dF)("opacityBlue")),bo=(0,ac.ZP)(R.kC)(A||(A=(0,ab.Z)(["\n  height: 100%;\n"]))),bp=function(a,b){var c,d=a.length;if(0===d)return -1;var e=d-b.itemCount;return 0===e?-1:a[d-1].id===(null==(c=b.lastItem)?void 0:c.id)?e:99999},bq=function(a){var b=a.messages,c=b.length,d=(0,Q.useRef)(!1),e=(0,Q.useRef)(null),f=(0,Q.useRef)({itemCount:0}),g=(0,Q.useState)({index:0}),h=(0,Y.Z)(g,2),i=h[0],j=h[1];return(0,Q.useLayoutEffect)(function(){if(e.current){var a=bp(b,f.current);a>1&&(e.current.resetAfterIndex(0,!0),j({index:a}))}return function(){f.current={itemCount:c,lastItem:b[c-1]}}},[b,e,c]),(0,Q.useLayoutEffect)(function(){var a;null==e||null==(a=e.current)||a.scrollToItem(i.index,"start")},[e,i]),{setInfiniteListRef:function(a){return e.current=a,!1===d.current&&a&&(d.current=!0,a.scrollToItem(99999)),a}}},br=c(63825),bs=c(74930),bt=c.n(bs),bu=function(a){var b=a.text,c=b.match(/https?:\/\/\S+/g);return c?b.split(/(https?:\/\/\S+)/g).map(function(a){return c.includes(a)?Q.createElement("a",{"data-testid":"chat-message-link",className:"chat-message-link",key:bt()("chat-message-link-"),href:a,rel:"noopener noreferrer"},a):a}):b};bu.defaultProps={text:""};var bv=(0,Q.memo)(bu),bw={alertDangerBase:"palette.alert.danger.base",gray:"colors.gray",textAttributeLabel:"palette.text.attributeLabel",textWhite:"palette.text.white"},bx={center:"center",left:"flex-start",right:"flex-end"},by={alert:{background:bw.alertDangerBase,text:bw.textAttributeLabel},error:{background:bw.alertDangerBase,text:bw.textAttributeLabel},gray:{background:bw.gray,text:bw.textWhite},primary:{background:"palette.primary.base",text:bw.textWhite},secondary:{background:"palette.background.lighter",text:bw.textAttributeLabel}},bz={center:"8px",left:"8px 8px 8px 0",right:"8px 8px 0 8px"},bA=function(a){return a.palette in by?(0,ad.R)(by[a.palette].text)(a):"inherit"},bB=(0,ac.ZP)(R.xu).attrs(function(a){var b,c;return(0,P.Z)({backgroundColor:(b=a).palette in by?(0,ad.R)(by[b.palette].background)(b):"inherit",borderRadius:bz[(c=a).alignment],boxShadow:"4",color:bA(a),fontSize:2,lineHeight:(0,ad.R)("lineHeights.big")(a),maxWidth:"80%",padding:2,wordWrap:"break-word"},a)})(B||(B=(0,ab.Z)(["\n  .chat-message-link {\n    color: ",";\n    text-decoration: underline;\n  }\n"])),bA),bC=ac.ZP.span.attrs(function(a){return(0,P.Z)({},a)})(C||(C=(0,ab.Z)(["\n  word-wrap: break-word;\n  white-space: break-spaces;\n  line-height: 2;\n  text-indent: 2ch;\n  text-rendering: optimizeLegibility;\n  font-size: ","px;\n  text-align: justify;\n"])),(0,ad.R)("fontSizes.2")),bD=(0,ac.ZP)(R.kC).attrs(function(a){return(0,P.Z)({flexDirection:"column",paddingX:3,paddingY:2},a)})(D||(D=(0,ab.Z)(["\n  align-items: ",";\n"])),function(a){var b;return bx[(b=a).alignment]}),bE=(0,ac.ZP)("time").attrs(function(a){return(0,P.Z)({},a)})(E||(E=(0,ab.Z)(["\n  font-size: ","px;\n  float: right;\n  padding-top: 16px;\n"])),(0,ad.R)("fontSizes.0")),bF=(0,ac.ZP)("sub")({flex:1,visibility:"hidden"}),bG=new Intl.DateTimeFormat("pt-BR",{timeStyle:"short"}),bH=function(a){try{if(a){var b=new Date(a);return{asIsoString:a,asTime:bG.format(b)}}}catch(c){}return null},bI=["timestamp","renderCaption","children","alignment","palette"],bJ=function(a){var b=a.timestamp,c=a.renderCaption,d=a.children,e=a.alignment,f=a.palette,g=(0,aj.Z)(a,bI),h=(0,Q.useMemo)(function(){return bH(b)},[b]);return Q.createElement(bD,(0,P.Z)({"data-testid":"chat-message-root",alignment:e},g),Q.createElement(bB,{palette:f,alignment:e,"data-testid":"chat-message-content"},Q.createElement(bC,null,"string"==typeof d?Q.createElement(bv,{text:d}):d),h&&Q.createElement(Q.Fragment,null,Q.createElement(bF,{"aria-hidden":"true"},h.asTime),Q.createElement(bE,{"data-testid":"chat-message-time","aria-label":"Hora da mensagem: ".concat(h.asTime),title:"Hora da mensagem: ".concat(h.asTime),dateTime:h.asIsoString},h.asTime))),c&&Q.createElement(R.xu,{py:2},c))};bJ.defaultProps={children:"",renderCaption:null,timestamp:""};var bK=(0,Q.memo)(bJ),bL=c(25164),bM=ac.ZP.div(F||(F=(0,ab.Z)(["\n  background-color: ",";\n  overflow: hidden;\n  padding: 16px;\n\n  & > a {\n    box-shadow: ",";\n    border-radius: ",";\n    align-items: center;\n    padding: 8px 16px;\n\n    div > img {\n      max-height: 83px;\n    }\n  }\n"])),function(a){return(0,ad.ow)("white")(a)},(0,ad.R)("boxShadows.4"),function(a){return(0,ad.R)("radii.default")(a)}),bN={count:0,score:0},bO=function(){return 119},bP=function(a){var b=a.image,c=a.price,d=a.title,e=a.url;return Q.createElement(bM,{"data-testid":"chat-message-product"},Q.createElement(bL.Il,{displayMode:"list",installment:{amount:c,paymentMethodDescription:"",quantity:"0",totalAmount:c},title:d,image:b,rating:bN,url:e,allowEmptyRating:!1,hidePrice:!0,hidePriceMode:"hide"}))};bP.getHeight=bO;var bQ=bP,bR=["children","icon"],bS=function(a){var b=a.children,c=a.icon,d=(0,aj.Z)(a,bR);return Q.createElement(R.kC,d,c&&Q.createElement(R.xu,{p:"0 4px"},Q.createElement(aa.JO$,{name:c.key,color:c.color,width:16,height:16})),Q.createElement(R.xu,null,b))};bS.defaultProps={icon:{color:"text.primary"}};var bT=bS,bU=(0,ac.ZP)(R.zx)(G||(G=(0,ab.Z)(["\n  margin-left: ","px;\n  padding: ","px ","px;\n  min-width: 0;\n  border-radius: ",";\n  white-space: nowrap;\n\n  label {\n    font-size: ","px;\n    text-transform: none !important;\n  }\n"])),(0,ad.R)("space.2"),(0,ad.R)("space.1"),(0,ad.R)("space.3"),(0,ad.R)("radii.default"),(0,ad.R)("fontSizes.2")),bV=ac.ZP.span(H||(H=(0,ab.Z)(["\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  border: 1px solid ",";\n  border-style: dashed;\n  border-radius: ",";\n  padding: ","px ","px;\n  white-space: nowrap;\n"])),(0,ad.ow)("border.base"),(0,ad.R)("radii.default"),(0,ad.R)("space.1"),(0,ad.R)("space.3")),bW=(0,ac.ZP)(bB)(I||(I=(0,ab.Z)(["\n  display: flex;\n"]))),bX=["alignment","children","couponCode","palette"],bY=function(a){var b=a.alignment,c=a.children,d=a.couponCode,e=a.palette,f=(0,aj.Z)(a,bX),g=function(){navigator.clipboard.writeText(d)};return Q.createElement(Q.Fragment,null,Q.createElement(bK,(0,P.Z)({alignment:b,palette:e},f),c),Q.createElement(bD,(0,P.Z)({"data-testid":"chat-message-root",alignment:b},f),Q.createElement(bW,{palette:e,alignment:b},Q.createElement(bV,null,d),Q.createElement(bU,{color:"primary",variant:"contained",onClick:g},"Copiar c\xf3digo"))))};bY.defaultProps={children:"",renderCaption:null,timestamp:""};var bZ=(0,Q.memo)(bY),b$=c(10200),b_=(0,ac.ZP)(R.zx)(J||(J=(0,ab.Z)(["\n  padding: ","px ","px;\n  min-width: 0;\n  border-radius: ",";\n  white-space: nowrap;\n\n  label {\n    font-size: ","px;\n    text-transform: none !important;\n  }\n"])),(0,ad.R)("space.1"),(0,ad.R)("space.3"),(0,ad.R)("radii.default"),(0,ad.R)("fontSizes.2")),b0=(0,ac.ZP)(bB)(K||(K=(0,ab.Z)(["\n  display: flex;\n"]))),b1=["alignment","btnTitle","children","deepLink","palette"],b2=function(a){var b=a.alignment,c=a.btnTitle,d=a.children,e=a.deepLink,f=a.palette,g=(0,aj.Z)(a,b1);return Q.createElement(Q.Fragment,null,Q.createElement(bK,(0,P.Z)({alignment:b,palette:f},g),d),Q.createElement(bD,(0,P.Z)({"data-testid":"chat-message-root",alignment:b},g),Q.createElement(b0,{palette:f,alignment:b},Q.createElement(b$.Z,{href:e,target:"_blank",underline:!1},Q.createElement(b_,{color:"primary",variant:"contained"},c)))))};b2.defaultProps={children:"",renderCaption:null,timestamp:""};var b3=(0,Q.memo)(b2),b4=c(28316),b5=(0,ac.ZP)(R.xu)(L||(L=(0,ab.Z)(["\n  > div:first-child {\n    padding-bottom: 0;\n    padding-left: 0;\n    padding-right: 0;\n  }\n"]))),b6=ac.ZP.ul(M||(M=(0,ab.Z)(["\n  list-style: disc;\n  padding-left: ","px;\n"])),(0,ad.R)("space.3")),b7=ac.ZP.li(N||(N=(0,ab.Z)(["\n  margin: ","px 0;\n  line-height: ",";\n  font-size: ","px;\n"])),(0,ad.R)("space.3"),(0,ad.R)("lineHeights.big"),(0,ad.R)("fontSizes.2")),b8=function(a){var b=a.label,c=(0,Q.useState)(!1),d=(0,Y.Z)(c,2),e=d[0],f=d[1],g=function(){f(function(a){return!a})};return Q.createElement(Q.Fragment,null,Q.createElement(R.rU,{color:"text.primary",onClick:g},b),(0,b4.createPortal)(Q.createElement(b5,null,Q.createElement(R.Vq,{bg:"background.white",type:"dialog",position:"bottom",showClose:!0,fullScreen:!0,visible:e,onClickOutside:g},Q.createElement(R.xu,{p:"2","data-testid":"Dialog-Container"},Q.createElement(R.xv,{textAlign:"center",fontWeight:"bold",fontSize:4},"Regulamento Aprova\xe7\xe3o/Reprova\xe7\xe3o"),Q.createElement(R.xv,{textAlign:"center",color:"primary",fontSize:3,mb:4,mt:4},"Chat com lojista Magalu"),Q.createElement(R.xv,{lineHeight:"big",fontSize:2},"Para garantir a seguran\xe7a e qualidade da informa\xe7\xe3o, todas as mensagens passam por valida\xe7\xe3o."),Q.createElement(R.xv,{color:"primary",fontSize:2,mb:3,mt:3},"N\xe3o \xe9 permitido"),Q.createElement(b6,null,Q.createElement(b7,null,"Troca de informa\xe7\xf5es de contatos diretos (CPF, n\xfamero de telefone, e-mail, perfis em redes sociais e/ou endere\xe7o);"),Q.createElement(b7,null,"Conte\xfado ofensivo, preconceituoso e discriminat\xf3rio de qualquer natureza ou que ofendam a imagem do Magalu;"),Q.createElement(b7,null,"Enviar mensagens com informa\xe7\xf5es de pagamento;")),Q.createElement(R.xv,{color:"primary",fontSize:2,mb:3,mt:3},"Recomendamos"),Q.createElement(b6,null,Q.createElement(b7,null,"Compartilhamento de produtos apenas do site magazineluiza.com.br;"),Q.createElement(b7,null,"Caso tenha recebido informa\xe7\xe3o de mensagem bloqueada, analise os crit\xe9rios acima e envie novamente."))))),document.body))},b9=(0,Q.memo)(b8),ca={NOT_MODERATED:"Mensagem em an\xe1lise para aprova\xe7\xe3o.",REJECTED:"Mensagem bloqueada por conter dados sens\xedveis.",WAITING_MODERATION:"Mensagem em an\xe1lise para aprova\xe7\xe3o."},cb=function(a){var b=a.label,c=a.type,d=a.onClick;return"readmore"===c?Q.createElement(b9,{label:b}):"generic"===c?Q.createElement(R.rU,{color:"text.primary",onClick:d},b):null};cb.defaultProps={onClick:aq.noop};var cc=(0,Q.memo)(cb),cd={REPURCHASE:{btnTitle:"Comprar",deepLinkId:"deepLinkPDP"},REVIEW:{btnTitle:"Avaliar Produto",deepLinkId:"deepLinkReview"}},ce=function(a){var b=a.id,c=a.alignment,d=a.timestamp,e=a.palette,f=a.contentCaption,g=a.content,h=a.customFields,i=function(a){return a&&a.text?Q.createElement(bT,{icon:a.iconId},Q.createElement(br.Z,{fontSize:0},a.text),(null==a?void 0:a.clickAction)&&Q.createElement(cc,{label:a.clickAction.label,type:a.clickAction.type,onClick:a.clickAction.onClick})):null},j=function(){var a=arguments.length>0&& void 0!==arguments[0]?arguments[0]:{},b=Object.keys(a).find(function(a){return a.startsWith("deepLink")});return b&&Object.values(cd).find(function(a){return a.deepLinkId===b})||null};return Q.createElement(bn,{tabIndex:0,key:b,"data-testid":"chat-message-chain-node"},function(){if(h&&h.promoCouponCode)return Q.createElement(bZ,{alignment:c,timestamp:d,palette:e,renderCaption:i(f),couponCode:h.promoCouponCode},g);var a=j(h);return h&&a?Q.createElement(b3,{alignment:c,btnTitle:a.btnTitle,deepLink:h[null==a?void 0:a.deepLinkId],timestamp:d,palette:e,renderCaption:i(f)},g):"product"===e&&h?Q.createElement(bQ,{image:h.productImage,title:h.productTitle,url:h.productUrl}):Q.createElement(bK,{alignment:c,timestamp:d,palette:e,renderCaption:i(f)},g)}())};ce.defaultProps={contentCaption:null,customFields:void 0,timestamp:""};var cf=(0,Q.memo)(ce),cg=new Intl.DateTimeFormat("pt-BR",{day:"numeric",month:"numeric",year:"numeric"}),ch=["messages","store","infiniteListProps","postMessage"],ci=["hasNextItems","loading","onFetchMore"],cj=function(a){var b=a.messages,c=a.store,d=a.infiniteListProps,e=a.postMessage,f=(0,aj.Z)(a,ch),g=d.hasNextItems,h=d.loading,i=d.onFetchMore,j=(0,aj.Z)(d,ci),k=bq({messages:b}),l=k.setInfiniteListRef,m=k.onItemsRendered,n=(0,Q.useRef)(new Map);n.current=(0,Q.useMemo)(function(){var a,c,d;return a=b,d=new Map,null==a||a.forEach(function(a){var b;if(!Number.isNaN(Date.parse(b=a.timestamp))){var e=cg.format(new Date(a.timestamp));(void 0===c||c!==e)&&(d.set(a.id,{dateAsFormatPtBr:e}),c=e)}}),d},[b.length]);var o=(0,Q.useCallback)(function(a){var c=b[a],d=c.id;if(n.current.has(d)){var e=n.current.get(d).dateAsFormatPtBr;return Q.createElement(Q.Fragment,null,Q.createElement(ba,{tabIndex:0},Q.createElement("time",{dateTime:c.timestamp,"aria-label":"Data das mensagens: ".concat(e)},e)),Q.createElement(cf,c))}return Q.createElement(cf,c)},[b]),p="Chat com ".concat(c.description," .");return Q.createElement(bo,(0,P.Z)({flexDirection:"column","data-testid":"chat-message-chain-root"},f),Q.createElement(a5,{label:c.description,avatarIcon:"SellerStore"}),h&&Q.createElement(ag,{align:"top"}),Q.createElement(aF,{"data-testid":"chat-conversation-list",bg:"background.base"},Q.createElement(aE,(0,P.Z)({"aria-live":"polite","aria-relevant":"additions text","aria-label":p,innerTagName:"ol",listRef:l,itemCount:b.length,renderRow:o,onLoadPreviousItems:i,hasPreviousItems:g,loading:h,onItemsRendered:m},j))),Q.createElement(bm,{onSubmit:e.onSubmit,loading:e.loading,error:e.error}))};cj.defaultProps={infiniteListProps:{hasNextItems:!1,loading:!1,overscanCount:20},postMessage:{error:null,loading:!1,onSubmit:aq.noop},store:{description:""}};var ck=(0,Q.memo)(cj),cl=function(a){return Array.isArray(null==a?void 0:a.content)?a.content.map(function(a,b){return{data:a,key:b}}).map(function(b){var c=b.data,d=b.key;return Object.prototype.hasOwnProperty.call(c,"kind")?"link"===c.kind?Q.createElement(b9,{key:"message-".concat(a.id,"-").concat(d),label:c.label}):c.value:c}):null==a?void 0:a.content},cm=function(a){return({NOT_MODERATED:{color:"text.primary",key:"Clock"},REJECTED:{color:"text.error",key:"SecurityTip"},WAITING_MODERATION:{color:"text.primary",key:"Clock"}})[a.moderation.status]},cn=function(a,b){return"seller"===b?({APPROVED:"secondary",NOT_MODERATED:"secondary",REJECTED:"alert",WAITING_MODERATION:"gray"})[a.status]:"customer"===b?({APPROVED:"primary",NOT_MODERATED:"primary",REJECTED:"alert",WAITING_MODERATION:"primary"})[a.status]:"gray"},co=function(a){var b;return null!==(b=ca[a.moderation.status])&& void 0!==b?b:null},cp=function(a){var b;return!!(null==a?void 0:null==(b=a.customFields)?void 0:b.find(function(a){return"productId"===a.name}))},cq=function(a){var b;return!!(null==a?void 0:null==(b=a.customFields)?void 0:b.find(function(a){return"promoCouponCode"===a.name}))},cr=function(a){var b,c=Object.values(cd).map(function(a){return a.deepLinkId});return null==a?void 0:null==(b=a.customFields)?void 0:b.some(function(a){return c.includes(a.name)})},cs=function(a){var b;return null==a?void 0:null==(b=a.customFields)?void 0:b.reduce(function(a,b){return a[b.name]=b.value,a},{})},ct=function(a){var b,c=arguments.length>1&& void 0!==arguments[1]?arguments[1]:{},d=arguments.length>2&& void 0!==arguments[2]?arguments[2]:{};return{alignment:"center",content:a.content,customFields:(0,P.Z)({},a.id?cs(a):{productId:c.id,productImage:c.image,productTitle:c.title,productUrl:"".concat(null==d?void 0:null==(b=d.config)?void 0:b.desktopSiteDomain,"/").concat(c.url)}),id:a.id||c.id,palette:"product"}},cu=function(a){if(!a)return a;if(cp(a))return ct(a);if(cq(a)||cr(a))return{alignment:"left",content:cl(a),contentCaption:{clickAction:null,iconId:null,text:null},customFields:cs(a),id:a.id,palette:"secondary",timestamp:a.whenAt};var b,c,d=null,e=null,f=null,g=null,h=String((null==(c=a)?void 0:c.fromUser)?c.fromUser.type:"seller").toLowerCase();switch(h){case"seller":g=cn(a.moderation,"seller"),(e=co(a))&&(f=cm(a),d={label:"Saiba mais",type:"readmore"});break;case"system":g="alert";break;case"customer":g=cn(a.moderation,"customer"),"REJECTED"===a.moderation.status&&(e=ca.REJECTED,f=cm(a),d={label:"Saiba mais",type:"readmore"});break;default:g="gray"}return{alignment:({customer:"right",seller:"left",system:"center"})[b=h]||"center",content:cl(a),contentCaption:e?{clickAction:d,iconId:f,text:e}:null,id:a.id,palette:g,timestamp:null==a?void 0:a.whenAt}},cv=function(a){var b=a.error,c=a.message,d=a.handler,e=new Date,f="chat-message-id-".concat(e.getTime());return{alignment:"right",content:c,contentCaption:{clickAction:{label:"Clique aqui para reenviar.",onClick:d,type:"generic"},iconId:"SecurityTip",text:b},id:f,palette:"error",timestamp:e.toISOString()}},cw=c(85942),cx=function(a){var b=(0,Q.useState)([]),c=(0,Y.Z)(b,2),d=c[0],e=c[1],f=(0,Q.useState)([]),g=(0,Y.Z)(f,2),h=g[0],i=g[1];(0,Q.useEffect)(function(){var b,c=Array.isArray(b=a)?b.map(function(a){return cu(a)}):[];e(d.reduce(function(a,b){return c.find(function(a){return a.id===b.id})?a:[].concat((0,cw.Z)(a),[b])},[])),i(c)},[JSON.stringify(a)]);var j=(0,Q.useCallback)(function(a){e(function(b){return b.filter(function(b){return b.id!==a})})},[e]),k=(0,Q.useCallback)(function(a){e(function(b){return b.concat(a)})},[e]);return{addMessage:k,messages:h.concat(d),removeMessage:j}},cy=ac.ZP.div(O||(O=(0,ab.Z)(["\n  width: 100%;\n  font-family: 'MagaluTextos', sans-serif;\n"]))),cz=["postMessage"],cA=["result","fetchMore","refetch"];function cB(){cB=function(){return a};var a={},b=Object.prototype,c=b.hasOwnProperty,d=Object.defineProperty||function(a,b,c){a[b]=c.value},e="function"==typeof Symbol?Symbol:{},f=e.iterator||"@@iterator",g=e.asyncIterator||"@@asyncIterator",h=e.toStringTag||"@@toStringTag";function i(a,b,c){return Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}),a[b]}try{i({},"")}catch(j){i=function(a,b,c){return a[b]=c}}function k(a,b,c,e){var f=Object.create((b&&b.prototype instanceof n?b:n).prototype);return d(f,"_invoke",{value:w(a,c,new A(e||[]))}),f}function l(a,b,c){try{return{type:"normal",arg:a.call(b,c)}}catch(d){return{type:"throw",arg:d}}}a.wrap=k;var m={};function n(){}function o(){}function p(){}var q={};i(q,f,function(){return this});var r=Object.getPrototypeOf,s=r&&r(r(B([])));s&&s!==b&&c.call(s,f)&&(q=s);var t=p.prototype=n.prototype=Object.create(q);function u(a){["next","throw","return"].forEach(function(b){i(a,b,function(a){return this._invoke(b,a)})})}function v(a,b){var e;function f(d,e,g,h){var i=l(a[d],a,e);if("throw"!==i.type){var j=i.arg,k=j.value;return k&&"object"==(0,ak.Z)(k)&&c.call(k,"__await")?b.resolve(k.__await).then(function(a){f("next",a,g,h)},function(a){f("throw",a,g,h)}):b.resolve(k).then(function(a){j.value=a,g(j)},function(a){return f("throw",a,g,h)})}h(i.arg)}d(this,"_invoke",{value:function(a,c){function d(){return new b(function(b,d){f(a,c,b,d)})}return e=e?e.then(d,d):d()}})}function w(a,b,c){var d="suspendedStart";return function(e,f){if("executing"===d)throw Error("Generator is already running");if("completed"===d){if("throw"===e)throw f;return C()}for(c.method=e,c.arg=f;;){var g=c.delegate;if(g){var h=x(g,c);if(h){if(h===m)continue;return h}}if("next"===c.method)c.sent=c._sent=c.arg;else if("throw"===c.method){if("suspendedStart"===d)throw d="completed",c.arg;c.dispatchException(c.arg)}else"return"===c.method&&c.abrupt("return",c.arg);d="executing";var i=l(a,b,c);if("normal"===i.type){if(d=c.done?"completed":"suspendedYield",i.arg===m)continue;return{value:i.arg,done:c.done}}"throw"===i.type&&(d="completed",c.method="throw",c.arg=i.arg)}}}function x(a,b){var c=a.iterator[b.method];if(void 0===c){if(b.delegate=null,"throw"===b.method){if(a.iterator.return&&(b.method="return",b.arg=void 0,x(a,b),"throw"===b.method))return m;b.method="throw",b.arg=TypeError("The iterator does not provide a 'throw' method")}return m}var d=l(c,a.iterator,b.arg);if("throw"===d.type)return b.method="throw",b.arg=d.arg,b.delegate=null,m;var e=d.arg;return e?e.done?(b[a.resultName]=e.value,b.next=a.nextLoc,"return"!==b.method&&(b.method="next",b.arg=void 0),b.delegate=null,m):e:(b.method="throw",b.arg=TypeError("iterator result is not an object"),b.delegate=null,m)}function y(a){var b={tryLoc:a[0]};1 in a&&(b.catchLoc=a[1]),2 in a&&(b.finallyLoc=a[2],b.afterLoc=a[3]),this.tryEntries.push(b)}function z(a){var b=a.completion||{};b.type="normal",delete b.arg,a.completion=b}function A(a){this.tryEntries=[{tryLoc:"root"}],a.forEach(y,this),this.reset(!0)}function B(a){if(a){var b=a[f];if(b)return b.call(a);if("function"==typeof a.next)return a;if(!isNaN(a.length)){var d=-1,e=function b(){for(;++d<a.length;)if(c.call(a,d))return b.value=a[d],b.done=!1,b;return b.value=void 0,b.done=!0,b};return e.next=e}}return{next:C}}function C(){return{value:void 0,done:!0}}return o.prototype=p,d(t,"constructor",{value:p,configurable:!0}),d(p,"constructor",{value:o,configurable:!0}),o.displayName=i(p,h,"GeneratorFunction"),a.isGeneratorFunction=function(a){var b="function"==typeof a&&a.constructor;return!!b&&(b===o||"GeneratorFunction"===(b.displayName||b.name))},a.mark=function(a){return Object.setPrototypeOf?Object.setPrototypeOf(a,p):(a.__proto__=p,i(a,h,"GeneratorFunction")),a.prototype=Object.create(t),a},a.awrap=function(a){return{__await:a}},u(v.prototype),i(v.prototype,g,function(){return this}),a.AsyncIterator=v,a.async=function(b,c,d,e,f){void 0===f&&(f=Promise);var g=new v(k(b,c,d,e),f);return a.isGeneratorFunction(c)?g:g.next().then(function(a){return a.done?a.value:g.next()})},u(t),i(t,h,"Generator"),i(t,f,function(){return this}),i(t,"toString",function(){return"[object Generator]"}),a.keys=function(a){var b=Object(a),c=[];for(var d in b)c.push(d);return c.reverse(),function a(){for(;c.length;){var d=c.pop();if(d in b)return a.value=d,a.done=!1,a}return a.done=!0,a}},a.values=B,A.prototype={constructor:A,reset:function(a){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(z),!a)for(var b in this)"t"===b.charAt(0)&&c.call(this,b)&&!isNaN(+b.slice(1))&&(this[b]=void 0)},stop:function(){this.done=!0;var a=this.tryEntries[0].completion;if("throw"===a.type)throw a.arg;return this.rval},dispatchException:function(a){if(this.done)throw a;var b=this;function d(c,d){return g.type="throw",g.arg=a,b.next=c,d&&(b.method="next",b.arg=void 0),!!d}for(var e=this.tryEntries.length-1;e>=0;--e){var f=this.tryEntries[e],g=f.completion;if("root"===f.tryLoc)return d("end");if(f.tryLoc<=this.prev){var h=c.call(f,"catchLoc"),i=c.call(f,"finallyLoc");if(h&&i){if(this.prev<f.catchLoc)return d(f.catchLoc,!0);if(this.prev<f.finallyLoc)return d(f.finallyLoc)}else if(h){if(this.prev<f.catchLoc)return d(f.catchLoc,!0)}else{if(!i)throw Error("try statement without catch or finally");if(this.prev<f.finallyLoc)return d(f.finallyLoc)}}}},abrupt:function(a,b){for(var d=this.tryEntries.length-1;d>=0;--d){var e=this.tryEntries[d];if(e.tryLoc<=this.prev&&c.call(e,"finallyLoc")&&this.prev<e.finallyLoc){var f=e;break}}f&&("break"===a||"continue"===a)&&f.tryLoc<=b&&b<=f.finallyLoc&&(f=null);var g=f?f.completion:{};return g.type=a,g.arg=b,f?(this.method="next",this.next=f.finallyLoc,m):this.complete(g)},complete:function(a,b){if("throw"===a.type)throw a.arg;return"break"===a.type||"continue"===a.type?this.next=a.arg:"return"===a.type?(this.rval=this.arg=a.arg,this.method="return",this.next="end"):"normal"===a.type&&b&&(this.next=b),m},finish:function(a){for(var b=this.tryEntries.length-1;b>=0;--b){var c=this.tryEntries[b];if(c.finallyLoc===a)return this.complete(c.completion,c.afterLoc),z(c),m}},catch:function(a){for(var b=this.tryEntries.length-1;b>=0;--b){var c=this.tryEntries[b];if(c.tryLoc===a){var d=c.completion;if("throw"===d.type){var e=d.arg;z(c)}return e}}throw Error("illegal catch attempt")},delegateYield:function(a,b,c){return this.delegate={iterator:B(a),resultName:b,nextLoc:c},"next"===this.method&&(this.arg=void 0),m}},a}var cC=function(a){var b,c,d,e,f=a.structure,g=a.store,h=a.product,i=a.conversation,j=a.onReceiveMessages,k=a.static,l=a.user,m=(0,X.Np)(),n=m.publish,o=(0,W.Cv)({structure:f}),p=o.data,q=(0,Q.useRef)(),r=(0,Q.useState)(f.route.conversationId||i.id),s=(0,Y.Z)(r,2),t=s[0],u=s[1],v=(0,_.useChatPostMessage)({product:h,sender:(e=l)?{fullname:e.name,id:e.id,username:e.email}:e,staticProps:k,structure:f}),w=v.postMessage,x=(0,aj.Z)(v,cz),y=(0,_.useChatMessages)({conversationId:t,onReceiveMessages:j,staticProps:k,userId:l.id}),z=y.result,A=y.fetchMore,B=y.refetch,C=(0,aj.Z)(y,cA),D=(0,_.useChatGetLastProduct)({conversationId:t,staticProps:k}),E=D.lastProduct,F=cx(null!==(b=null==z?void 0:z.data)&& void 0!==b?b:[]),G=F.messages,H=F.addMessage,I=F.removeMessage;(0,Q.useEffect)(function(){(null==z?void 0:z.data)&&h&&!q.current&&E!==h.id&&(H(ct({},h,f)),q.current=h)},[null==z?void 0:z.data]);var J,K=(0,Q.useState)(null),L=(0,Y.Z)(K,2),M=L[0],N=L[1],O=(0,Q.useCallback)((J=(0,a1.Z)(cB().mark(function a(b,c){var d,e,f;return cB().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,N(null),d={content:b.message},a.next=5,w(g,t,d,E);case 5:e=a.sent,c&&I(c),u(e.conversationId),H(cu((0,P.Z)({},e.message,d))),b.ref.resetForm(),a.next=16;break;case 12:a.prev=12,a.t0=a.catch(0),!c&&(null==a.t0?void 0:a.t0.allowRetry)&&(b.ref.resetForm(),f=cv({error:"Houve um erro ao tentar enviar a mensagem.",handler:function(){O(b,f.id)},message:b.message}),H(f)),(null==a.t0?void 0:a.t0.allowRetry)=== !1&&N(a.t0.message);case 16:case"end":return a.stop()}},a,null,[[0,12]])})),function(a,b){return J.apply(this,arguments)}),[w,H,I]);return(0,Q.useEffect)(function(){if(p){var a,b;n("sellerchat:conversation:onview",{sellerName:g.description,userId:p.id,userIsLogged:p.isLogged,userLocation:(0,P.Z)({},null==f?void 0:null==(a=f.cookies)?void 0:a.location,{zipCode:null==f?void 0:null==(b=f.cookies)?void 0:b.zipCode})})}},[p]),Q.createElement(cy,{"aria-busy":C.loading,"data-testid":"MessageChainRoot-Root"},C.error&&Q.createElement(ai,{onRetry:B}),null===C.error&&z&&Q.createElement(ck,{"data-testid":"MessageChain-Root",store:g,messages:G,postMessage:{error:M,loading:x.loading,onSubmit:O},infiniteListProps:{hasNextItems:!!(null==(c=z.pagination)?void 0:null==(d=c.links)?void 0:d.next),itemKey:function(a){var b;return null==G?void 0:null==(b=G[a])?void 0:b.id},loading:C.loading,onFetchMore:A}}))};cC.defaultProps={conversation:{},onReceiveMessages:function(){},product:void 0,static:{},store:{}},cC.ssr=!0;var cD=(0,V.Z)(cC),cE=function(a){var b,c,d,e=a.data,f=a.structure,g=a.static,h=((null==e?void 0:e.product)||{}).seller,i=(0,W.Cv)({structure:f}).data,j=(0,_.useChatConversation)({sellerId:(null==h?void 0:h.id)||(null==(d=f.route)?void 0:d.sellerId),staticProps:g,userId:null==i?void 0:i.id}),k=j.conversation,l=j.loading,m=j.saveConversationAsRead;(0,Q.useEffect)(function(){m()},[m]);var n=(0,Q.useCallback)(function(a){m((null==a?void 0:a.filter(function(a){var b,c=["REJECTED","APPROVED"].includes(null==(b=a.moderation)?void 0:b.status);return!a.fromUser&&c})).length)},[m]);return(null==i?void 0:i.isLogged)=== !1?Q.createElement(R.kC,{width:"100%",justifyContent:"center",alignItems:"center"},Q.createElement(R.xv,null,"Usu\xe1rio n\xe3o autorizado")):l||(null==i?void 0:i.isLogged)===void 0?Q.createElement(R.SX,null):Q.createElement(cD,{static:g,structure:f,store:h||{description:(null==k?void 0:null==(b=k.toUser)?void 0:b.fullName)||"",id:null==k?void 0:null==(c=k.toUser)?void 0:c.refKey},conversation:k,product:null==e?void 0:e.product,user:i,onReceiveMessages:n})};cE.defaultProps={data:{},static:{},structure:{}},cE.ssr=!0;var cF=(0,V.Z)(cE)}}])
//# sourceMappingURL=2061-59a81b349fc80bcd.js.map